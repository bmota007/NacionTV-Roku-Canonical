<?xml version="1.0" encoding="utf-8"?>
<component name="RowListItems" extends="Group">
  <interface>
    <field id="itemContent" type="node" onChange="itemContentChanged" />
    <field id="width" type="float" onChange="updateLayout" />
    <field id="height" type="float" onChange="updateLayout" />
  </interface>

  <script type="text/brightscript"><![CDATA[
    sub init()
      m.Poster = m.top.findNode("poster")
      m.Label  = m.top.findNode("label")
      m.Focus  = m.top.findNode("focusRect")
    end sub

    sub itemContentChanged()
      if m.top.itemContent = invalid then return

      posterUri = invalid
      titleTxt  = invalid

      ' poster
      if m.top.itemContent.HDPosterUrl <> invalid then
        posterUri = m.top.itemContent.HDPosterUrl
      else if m.top.itemContent.hdposterurl <> invalid then
        posterUri = m.top.itemContent.hdposterurl
      else if m.top.itemContent.logo <> invalid then
        posterUri = m.top.itemContent.logo
      end if

      ' title
      if m.top.itemContent.Title <> invalid then
        titleTxt = m.top.itemContent.Title
      else if m.top.itemContent.title <> invalid then
        titleTxt = m.top.itemContent.title
      end if

      if m.Poster <> invalid and posterUri <> invalid then m.Poster.uri = posterUri
      if m.Label <> invalid then
        if titleTxt <> invalid then
          m.Label.text = titleTxt
        else
          m.Label.text = ""
        end if
      end if
    end sub

    sub updateLayout()
      w = m.top.width
      h = m.top.height

      if m.Focus <> invalid then
        m.Focus.width = w
        m.Focus.height = h
      end if

      if m.Poster <> invalid then
        m.Poster.width = w
        m.Poster.height = h - 60
      end if

      if m.Label <> invalid then
        m.Label.width = w
        m.Label.height = 60
        m.Label.translation = [0, h - 60]
      end if
    end sub
  ]]></script>

  <children>
    <!-- Focus outline (RowList will toggle opacity automatically using focus/defocus states) -->
    <Rectangle id="focusRect"
               width="500" height="320"
               color="0xFFFFFFFF"
               opacity="0.0" />

    <!-- Poster -->
    <Poster id="poster"
            width="500" height="260"
            loadDisplayMode="scaleToFill" />

    <!-- EN VIVO pill -->
    <Rectangle id="liveBadge"
               width="120" height="32"
               translation="[14,14]"
               color="0xD32F2FFF"
               opacity="1.0" />
    <Label id="liveLabel"
           text="EN VIVO"
           translation="[30,19]"
           font="font:SmallBoldSystemFont"
           color="0xFFFFFFFF" />

    <!-- Bottom title bar -->
    <Rectangle id="titleBar"
               width="500" height="60"
               translation="[0,260]"
               color="0x000000"
               opacity="0.55" />

    <Label id="label"
           width="500" height="60"
           translation="[0,260]"
           horizAlign="center"
           vertAlign="center"
           color="0xFFFFFFFF"
           font="font:MediumBoldSystemFont"
           text="" />
  </children>
</component>